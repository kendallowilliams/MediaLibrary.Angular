<div class="flex items-stretch gap-[20px]">
  <ml-card class="shrink-0">
    <ml-card-body>
      <div class="flex gap-[30px]">
        <div class="">
          <fa-icon *ngIf="faMusic" [icon]="faMusic" [classes]="['fa-2xl']"></fa-icon>
        </div>
        <div class="flex flex-col items-start gap-[10px]">
          <ng-container *ngIf="albums$ | async as albums">
            <button (click)="updateCategory('Album')">
              <fa-icon [icon]="faCompactDisc"></fa-icon>
              <span class="ml-[5px]">Albums</span>
            </button>
          </ng-container>
          <ng-container *ngIf="artists$ | async as artists">
            <button (click)="updateCategory('Artist')">
              <fa-icon [icon]="faUser"></fa-icon>
              <span class="ml-[5px]">Artists</span>
            </button>
          </ng-container>
          <ng-container *ngIf="tracks$ | async as tracks">
            <button (click)="updateCategory('Song')">
              <fa-icon [icon]="faHeadphones"></fa-icon>
              <span class="ml-[5px]">Songs</span>
            </button>
          </ng-container>
          <ng-container *ngIf="playlists$ | async as playlists">
            <button (click)="updateCategory('Playlist')">
              <fa-icon [icon]="faList"></fa-icon>
              <span class="ml-[5px]">Playlists</span>
            </button>
          </ng-container>
        </div>
      </div>
    </ml-card-body>
  </ml-card>

  <ng-container *ngIf="selectedCategory$ | async as category">
    <ml-card class="shrink-0">
      <ml-card-body>
        <div class="flex gap-[30px]">
          <div class="flex">
            <ng-container [ngSwitch]="category">
              <fa-icon *ngSwitchCase="'Album'" [icon]="faCompactDisc" [classes]="['fa-2xl']"></fa-icon>
              <fa-icon *ngSwitchCase="'Artist'" [icon]="faUser" [classes]="['fa-2xl']"></fa-icon>
              <fa-icon *ngSwitchCase="'Song'" [icon]="faHeadphones" [classes]="['fa-2xl']"></fa-icon>
              <fa-icon *ngSwitchCase="'Playlist'" [icon]="faList" [classes]="['fa-2xl']"></fa-icon>
            </ng-container>
          </div>
          <div class="flex flex-col">
            <ng-container [ngSwitch]="category">
              <ng-container *ngSwitchCase="'Album'" >
                <div *ngFor="let album of albums$ | async">
                  <button (click)="addSubCategory('Album', album.id)">{{album.title}}</button>
                </div>
              </ng-container>
              <ng-container *ngSwitchCase="'Artist'">
                <div *ngFor="let artist of artists$ | async">
                  <button (click)="addSubCategory('Artist', artist.id)">{{artist.name}}</button>
                </div>
              </ng-container>
              <ng-container *ngSwitchCase="'Song'">
                <div *ngFor="let track of tracks$ | async">
                  <button>{{track.title}}</button>
                </div>
              </ng-container>
              <ng-container *ngSwitchCase="'Playlist'">
                <div *ngFor="let playlist of playlists$ | async">
                  <button (click)="addSubCategory('Playlist', playlist.id)">{{playlist.name}}</button>
                </div>
              </ng-container>
            </ng-container>
          </div>
        </div>
      </ml-card-body>
    </ml-card>
  </ng-container>

  <ng-container *ngFor="let category of subCategories$ | async; trackBy: subCategoryTrackBy"
    [ngTemplateOutlet]="subCategory" [ngTemplateOutletContext]="{$implicit: category}">
  </ng-container>
</div>

<ng-template #subCategory let-category>
  <ml-card class="shrink-0" *ngIf="category.type !== 'Song'">
    <ml-card-body>
      <div class="flex gap-[30px]">
        <div class="">
          <fa-icon [icon]="category.icon" [classes]="['fa-2xl']"></fa-icon>
        </div>
        <div class="">
          <ng-container [ngSwitch]="category.type">
            <ng-container *ngSwitchCase="'Album'" >
              <div *ngFor="let track of getTracksByAlbumId(category.id)">
                <button>{{track.title}}</button>
              </div>
            </ng-container>
            <ng-container *ngSwitchCase="'Artist'">
              <div *ngFor="let album of getAlbumsByArtistId(category.id)">
                <button>{{album.title}}</button>
              </div>
            </ng-container>
            <ng-container *ngSwitchCase="'Playlist'">
              <div *ngFor="let track of tracks$ | async">
                <button>{{track.title}}</button>
              </div>
            </ng-container>
          </ng-container>
        </div>
      </div>
    </ml-card-body>
  </ml-card>
</ng-template>
